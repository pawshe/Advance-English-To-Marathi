<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Flashcards: English to Marathi</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Custom Flip Animation Styles */
        .perspective-1000 {
            perspective: 1000px;
        }
        
        .transform-style-3d {
            transform-style: preserve-3d;
        }
        
        .backface-hidden {
            backface-visibility: hidden;
        }
        
        .rotate-y-180 {
            transform: rotateY(180deg);
        }

        /* Smooth gradient animation */
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .animate-gradient {
            background-size: 200% 200%;
            animation: gradient 6s ease infinite;
        }

        /* Scrollbar hide */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Icons Component ---
        const Icon = ({ name, size = 24, className = "" }) => {
            const iconRef = useRef(null);
            
            useEffect(() => {
                if (window.lucide && iconRef.current) {
                    const iconElement = window.lucide.icons[name];
                    if (iconElement) {
                        const svg = iconElement.toSvg({ 
                            width: size, 
                            height: size, 
                            class: className 
                        });
                        iconRef.current.innerHTML = svg;
                    }
                }
            }, [name, size, className]);

            return <span ref={iconRef} className="inline-flex items-center justify-center" />;
        };

        // --- Main Application ---
        function App() {
            const [apiKey, setApiKey] = useState('');
            const [showSettings, setShowSettings] = useState(false);
            const [topic, setTopic] = useState('Basic Greetings');
            const [cards, setCards] = useState([]);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);
            const [currentIndex, setCurrentIndex] = useState(0);
            const [isFlipped, setIsFlipped] = useState(false);

            // Load API key from local storage on mount
            useEffect(() => {
                const storedKey = localStorage.getItem('https://pawshe.github.io/Advance-English-To-Marathi/');
                if (storedKey) setApiKey(storedKey);
            }, []);

            // Save API key
            const handleSaveKey = (key) => {
                setApiKey(key);
                localStorage.setItem('AIzaSyBqqN-I_pbZ6gnNE4vZDcZnujEMgGLU6PU', key);
                setShowSettings(false);
            };

            const generateCards = async (topicOverride = null) => {
                const currentTopic = topicOverride || topic;

                if (!apiKey) {
                    setError("Please enter your Google Gemini API Key first.");
                    setShowSettings(true);
                    return;
                }

                setLoading(true);
                setError(null);
                setCards([]);
                setCurrentIndex(0);
                setIsFlipped(false);
                
                if (topicOverride) {
                    setTopic(topicOverride);
                }

                try {
                    const prompt = `
                        Generate 10 pairs of English to Marathi flashcards about the topic: "${currentTopic}".
                        
                        Return ONLY a raw JSON array. Do not include markdown formatting like \`\`\`json.
                        Each object in the array must have:
                        - "front": The English word or phrase.
                        - "back": The Marathi translation followed by the pronunciation in brackets.
                        
                        Example format:
                        [
                            {"front": "Hello", "back": "Namaskar (नमस्कार)"},
                            {"front": "Thank you", "back": "Dhanyavaad (धन्यवाद)"}
                        ]
                    `;

                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{ text: prompt }]
                            }]
                        })
                    });

                    const data = await response.json();

                    if (data.error) {
                        throw new Error(data.error.message);
                    }
                    
                    if (!data.candidates || data.candidates.length === 0) {
                        throw new Error("API returned no candidates. Try a different topic or check API quota.");
                    }

                    const textResponse = data.candidates[0].content.parts[0].text;
                    const cleanJson = textResponse.replace(/```json/g, '').replace(/```/g, '').trim();
                    const parsedCards = JSON.parse(cleanJson);

                    setCards(parsedCards);
                } catch (err) {
                    setError("Failed to generate cards. Please check your API key and try again. Error: " + err.message);
                } finally {
                    setLoading(false);
                }
            };
            
            const generateAdvancedCards = () => {
                const advancedTopic = 'Advanced English: C1/C2 vocabulary and professional idioms';
                generateCards(advancedTopic);
            };

            const nextCard = () => {
                if (cards.length === 0) return;
                
                setIsFlipped(false);
                setTimeout(() => {
                    setCurrentIndex((prev) => (prev + 1) % cards.length);
                }, 150);
            };

            const prevCard = () => {
                if (cards.length === 0) return;
                
                setIsFlipped(false);
                setTimeout(() => {
                    setCurrentIndex((prev) => (prev - 1 + cards.length) % cards.length);
                }, 150);
            };

            const handleFlip = () => {
                setIsFlipped(!isFlipped);
            };
            
            // Keyboard navigation
            useEffect(() => {
                const handleKeyDown = (e) => {
                    if (cards.length === 0) return;

                    if (e.code === 'Space') {
                        e.preventDefault();
                        handleFlip();
                    }
                    if (e.code === 'ArrowRight') nextCard();
                    if (e.code === 'ArrowLeft') prevCard();
                };

                document.addEventListener('keydown', handleKeyDown);
                return () => {
                    document.removeEventListener('keydown', handleKeyDown);
                };
            }, [cards.length, handleFlip]);


            return (
                <div className="min-h-screen flex flex-col font-sans">
                    {/* Header */}
                    <header className="bg-white shadow-sm p-4 flex justify-between items-center sticky top-0 z-10">
                        <div className="flex items-center gap-2 text-indigo-600">
                            <Icon name="languages" className="text-indigo-600" />
                            <h1 className="text-xl font-bold tracking-tight">English to Marathi Flashcards</h1>
                        </div>
                        <button 
                            onClick={() => setShowSettings(!showSettings)}
                            className="p-2 rounded-full hover:bg-gray-100 text-gray-600 transition-colors"
                        >
                            <Icon name="settings" />
                        </button>
                    </header>

                    {/* Main Content with Upper and Bottom Divs */}
                    <main className="flex-1 max-w-2xl w-full mx-auto p-4 flex flex-col gap-6">
                        
                        {/* ------------------------------------- */}
                        {/* UPPER DIV: Controls and Status */}
                        {/* ------------------------------------- */}
                        <div id="upper-div" className="bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col gap-4">
                            
                            {/* API Key Modal / Settings Panel */}
                            {showSettings && (
                                <div className="bg-gray-50 p-4 rounded-lg border border-gray-200 animate-fade-in">
                                    <h2 className="text-lg font-semibold mb-3 flex items-center gap-2">
                                        <Icon name="key" size={20} /> API Configuration
                                    </h2>
                                    <p className="text-sm text-gray-500 mb-3">
                                        Get your key at <a href="https://aistudio.google.com/" target="_blank" className="text-indigo-600 hover:underline font-medium">aistudio.google.com</a>.
                                    </p>
                                    <input
                                        type="password"
                                        placeholder="AIzaSyBqqN-I_pbZ6gnNE4vZDcZnujEMgGLU6PU"
                                        value={apiKey}
                                        onChange={(e) => setApiKey(e.target.value)}
                                        className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none mb-3 text-sm"
                                    />
                                    <button 
                                        onClick={() => handleSaveKey(apiKey)}
                                        className="w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors font-medium text-sm"
                                    >
                                        Save Key
                                    </button>
                                </div>
                            )}

                            {/* Generator Controls */}
                            <div className="flex flex-col sm:flex-row gap-3">
                                <input
                                    type="text"
                                    value={topic}
                                    onChange={(e) => setTopic(e.target.value)}
                                    placeholder="Enter a topic (e.g., 'Fruits', 'At the market')"
                                    className="flex-1 p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:outline-none"
                                />
                                <button
                                    onClick={() => generateCards()}
                                    disabled={loading}
                                    className={`
                                        px-6 py-3 rounded-lg font-bold text-white shadow-md transition-all flex items-center justify-center gap-2
                                        ${loading ? 'bg-indigo-400 cursor-not-allowed' : 'bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 hover:shadow-lg'}
                                    `}
                                >
                                    {loading ? (
                                        <>
                                            <div className="animate-spin h-5 w-5 border-2 border-white border-t-transparent rounded-full"></div>
                                            Generating...
                                        </>
                                    ) : (
                                        <>
                                            <Icon name="sparkles" size={20} />
                                            Generate
                                        </>
                                    )}
                                </button>
                            </div>

                            {/* Error Message */}
                            {error && (
                                <div className="bg-red-50 text-red-700 p-4 rounded-lg border border-red-200 flex items-start gap-3 mt-2">
                                    <Icon name="alert-circle" className="mt-0.5 flex-shrink-0" />
                                    <p>{error}</p>
                                </div>
                            )}

                            {/* Empty State */}
                            {!loading && cards.length === 0 && !error && (
                                <div className="text-center py-6 text-gray-400 border-2 border-dashed border-gray-200 rounded-lg mt-2">
                                    <Icon name="layers" size={32} className="mx-auto mb-2 opacity-50" />
                                    <p className="text-md">Enter a topic and hit generate to start learning!</p>
                                </div>
                            )}
                        </div>
                        
                        {/* ------------------------------------- */}
                        {/* BOTTOM DIV: Flashcard and Navigation */}
                        {/* ------------------------------------- */}
                        {cards.length > 0 && !loading && (
                            <div id="bottom-div" className="flex flex-col items-center gap-6 bg-white p-6 sm:p-8 rounded-xl shadow-lg border border-gray-100">

                                {/* Progress Indicator */}
                                <div className="text-sm font-medium text-gray-500 bg-gray-50 px-4 py-1 rounded-full shadow-inner border border-gray-100">
                                    Card {currentIndex + 1} of {cards.length}
                                </div>

                                {/* The Card Scene (Vertical Mobile Optimized) */}
                                <div 
                                    className="w-full h-80 sm:h-96 perspective-1000 cursor-pointer group"
                                    onClick={handleFlip}
                                >
                                    <div className={`
                                        relative w-full h-full text-center transition-transform duration-500 transform-style-3d shadow-xl rounded-2xl
                                        ${isFlipped ? 'rotate-y-180' : ''}
                                    `}>
                                        
                                        {/* FRONT */}
                                        <div className="absolute w-full h-full backface-hidden bg-white rounded-2xl border border-gray-100 flex flex-col items-center justify-center p-8">
                                            <div className="absolute top-4 left-4 text-xs font-bold text-indigo-500 uppercase tracking-widest">English</div>
                                            <h3 className="text-3xl sm:text-4xl font-bold text-gray-800 break-words max-w-full">
                                                {cards[currentIndex].front}
                                            </h3>
                                            <p className="absolute bottom-6 text-gray-400 text-sm animate-pulse">Tap to flip</p>
                                        </div>

                                        {/* BACK */}
                                        <div className="absolute w-full h-full backface-hidden rotate-y-180 bg-gradient-to-br from-indigo-600 to-purple-700 text-white rounded-2xl flex flex-col items-center justify-center p-8">
                                            <div className="absolute top-4 left-4 text-xs font-bold text-indigo-200 uppercase tracking-widest">Marathi</div>
                                            <h3 className="text-3xl sm:text-4xl font-bold mb-2 break-words max-w-full">
                                                {cards[currentIndex].back.split('(')[0].trim()}
                                            </h3>
                                            {/* Pronunciation usually comes in brackets, let's style it if present */}
                                            {cards[currentIndex].back.includes('(') && (
                                                <p className="text-indigo-200 text-lg">
                                                    ({cards[currentIndex].back.split('(')[1].trim()}
                                                </p>
                                            )}
                                        </div>
                                    </div>
                                </div>

                                {/* Controls (Navigation) */}
                                <div className="flex items-center gap-6 w-full justify-center mt-4">
                                    {/* Previous Card Button */}
                                    <button 
                                        onClick={prevCard}
                                        disabled={loading || cards.length === 0}
                                        className="w-20 h-20 rounded-full bg-gray-100 shadow-md hover:shadow-lg text-gray-700 transition-all flex flex-col items-center justify-center active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed ring-2 ring-gray-200"
                                    >
                                        <Icon name="arrow-left" size={24} className="text-indigo-600" />
                                        <span className="text-xs font-semibold mt-1">Prev</span>
                                    </button>
                                    
                                    {/* Flip/Show Button (Central, clear action button) */}
                                    <button 
                                        onClick={handleFlip}
                                        className="px-6 py-3 rounded-full bg-indigo-600 text-white shadow-xl hover:bg-indigo-700 transition-colors font-bold min-w-[150px] text-md active:scale-95"
                                    >
                                        {isFlipped ? 'Show English' : 'Show Marathi'}
                                    </button>

                                    {/* Next Card Button */}
                                    <button 
                                        onClick={nextCard}
                                        disabled={loading || cards.length === 0}
                                        className="w-20 h-20 rounded-full bg-gray-100 shadow-md hover:shadow-lg text-gray-700 transition-all flex flex-col items-center justify-center active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed ring-2 ring-gray-200"
                                    >
                                        <Icon name="arrow-right" size={24} className="text-indigo-600" />
                                        <span className="text-xs font-semibold mt-1">Next</span>
                                    </button>
                                </div>
                            </div>
                        )}
                    </main>

                    {/* Footer - Advanced English Link */}
                    <footer className="text-center p-6 text-gray-400 text-sm border-t border-gray-100 mt-auto">
                        <button 
                            onClick={generateAdvancedCards}
                            className="text-indigo-600 font-semibold hover:text-indigo-700 transition-colors disabled:opacity-50"
                            disabled={loading}
                        >
                            <Icon name="zap" size={16} className="inline mr-1 text-yellow-500" />
                            Switch to Advanced English Topics
                        </button>
                       
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>


